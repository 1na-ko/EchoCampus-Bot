# ITçŸ¥è¯†é—®ç­”æœºå™¨äºº - é¡¹ç›®å¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº**RAG(Retrieval-Augmented Generation)**æŠ€æœ¯çš„æ™ºèƒ½ITçŸ¥è¯†é—®ç­”æœºå™¨äºº,é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„,ç»“åˆSpring Bootã€Vue.jsã€PostgreSQLã€Milvusç­‰ç°ä»£åŒ–æŠ€æœ¯æ ˆå®ç°ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ’¬ æ™ºèƒ½é—®ç­”: åŸºäºRAGæŠ€æœ¯æä¾›å‡†ç¡®çš„ITçŸ¥è¯†é—®ç­”
- ğŸ“š çŸ¥è¯†åº“ç®¡ç†: æ”¯æŒæ–‡æ¡£ä¸Šä¼ ã€åˆ†ç±»ã€æ£€ç´¢å’Œå‘é‡åŒ–
- ğŸ’¾ å¯¹è¯å†å²: æ”¯æŒå¤šè½®å¯¹è¯,ä¿å­˜å¯¹è¯è®°å½•
- âš™ï¸ ç³»ç»Ÿé…ç½®: çµæ´»çš„ç³»ç»Ÿå‚æ•°é…ç½®
- ğŸ“Š æ•°æ®ç»Ÿè®¡: é—®ç­”ç»Ÿè®¡å’Œç³»ç»Ÿç›‘æ§

### æŠ€æœ¯æ ˆ

#### åç«¯
- **æ¡†æ¶**: Spring Boot 3.x
- **ORM**: MyBatis-Plus
- **æ•°æ®åº“**: PostgreSQL 15 + Milvus 2.x
- **AIæ¥å£**: é˜¿é‡Œäº‘ç™¾ç‚¼å¹³å° Qwen3-Embedding (text-embedding-v3) + DeepSeek V3.2
- **æ„å»ºå·¥å…·**: Maven
- **éƒ¨ç½²**: Docker + Docker Compose

#### å‰ç«¯
- **æ¡†æ¶**: Vue.js 3.3 + TypeScript
- **UIç»„ä»¶**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4
- **HTTP**: Axios
- **æ„å»ºå·¥å…·**: Vite

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

#### å¿…éœ€è½¯ä»¶
- Java 17+
- Maven 3.8+
- Node.js 16+
- PostgreSQL 15+
- Docker & Docker Compose
- Git

#### å¼€å‘å·¥å…·æ¨è
- IntelliJ IDEA (åç«¯)
- VS Code (å‰ç«¯)
- DBeaver (æ•°æ®åº“)
- Postman (APIæµ‹è¯•)

### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/yourusername/it-qabot.git
cd it-qabot
```

### 3. åç«¯é¡¹ç›®é…ç½®

#### 3.1 æ•°æ®åº“åˆå§‹åŒ–

æ‰§è¡Œæ•°æ®åº“è„šæœ¬:
```bash
psql -U postgres -d it_qabot -f docs/database/init.sql
```

æˆ–è€…ä½¿ç”¨æ•°æ®åº“å·¥å…·å¯¼å…¥ `æ•°æ®åº“è®¾è®¡.sql` æ–‡ä»¶ã€‚

#### 3.2 é…ç½®application.yml

```yaml
# src/main/resources/application.yml
server:
  port: 8080

spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/it_qabot
    username: qabot
    password: your_password
    driver-class-name: org.postgresql.Driver

# MyBatis-Plusé…ç½®
mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  mapper-locations: classpath*:mapper/*.xml

# AIæœåŠ¡é…ç½®
ai:
  aliyun:
    access-key: your_aliyun_access_key
    secret-key: your_aliyun_secret_key
    embedding-endpoint: https://dashscope.aliyuncs.com/compatible-mode/v1
    model: text-embedding-v3
  deepseek:
    api-key: your_deepseek_api_key
    api-url: https://api.deepseek.com/v1/chat/completions
    model: deepseek-v3.2

# Milvusé…ç½®
milvus:
  host: localhost
  port: 19530
  collection-name: it_knowledge
```

#### 3.3 è¿è¡Œåç«¯é¡¹ç›®

```bash
# å®‰è£…ä¾èµ–
mvn clean install

# è¿è¡Œé¡¹ç›®
mvn spring-boot:run

# æˆ–è€…æ‰“åŒ…åè¿è¡Œ
mvn clean package
java -jar target/it-qabot-1.0.0.jar
```

### 4. å‰ç«¯é¡¹ç›®é…ç½®

#### 4.1 å®‰è£…ä¾èµ–

```bash
cd it-qabot-frontend
npm install
# æˆ–ä½¿ç”¨yarn
yarn install
```

#### 4.2 é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.development` æ–‡ä»¶:
```env
VITE_API_BASE_URL=http://localhost:8080/api/v1
VITE_APP_NAME=ITçŸ¥è¯†é—®ç­”æœºå™¨äºº
```

#### 4.3 è¿è¡Œå‰ç«¯é¡¹ç›®

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# é¢„è§ˆæ„å»ºç»“æœ
npm run preview
```

### 5. Dockeréƒ¨ç½²(æ¨è)

#### 5.1 ä½¿ç”¨Docker Composeä¸€é”®éƒ¨ç½²

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend

# åœæ­¢æœåŠ¡
docker-compose down
```

#### 5.2 æœåŠ¡è®¿é—®

- **å‰ç«¯åº”ç”¨**: http://localhost
- **åç«¯API**: http://localhost:8080
- **APIæ–‡æ¡£**: http://localhost:8080/api/doc.html
- **PostgreSQL**: localhost:5432
- **Milvus**: localhost:19530

## ğŸ“ é¡¹ç›®ç»“æ„

### åç«¯é¡¹ç›®ç»“æ„
```
it-qabot/
â”œâ”€â”€ src/main/java/com/example/itqabot/
â”‚   â”œâ”€â”€ ItQabotApplication.java          # å¯åŠ¨ç±»
â”‚   â”œâ”€â”€ config/                          # é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ MyBatisConfig.java
â”‚   â”‚   â”œâ”€â”€ MilvusConfig.java
â”‚   â”‚   â””â”€â”€ AiServiceConfig.java
â”‚   â”œâ”€â”€ controller/                      # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ ChatController.java
â”‚   â”‚   â”œâ”€â”€ KnowledgeController.java
â”‚   â”‚   â””â”€â”€ UserController.java
â”‚   â”œâ”€â”€ service/                         # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ ChatService.java
â”‚   â”‚   â”œâ”€â”€ KnowledgeService.java
â”‚   â”‚   â””â”€â”€ AiService.java
â”‚   â”œâ”€â”€ mapper/                          # MyBatis Mapper
â”‚   â”œâ”€â”€ entity/                          # å®ä½“ç±»
â”‚   â”œâ”€â”€ dto/                             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â””â”€â”€ utils/                           # å·¥å…·ç±»
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yml
â”‚   â””â”€â”€ mapper/                          # MyBatis XMLæ˜ å°„
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ pom.xml
```

### å‰ç«¯é¡¹ç›®ç»“æ„
```
it-qabot-frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/                      # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatMessage.vue
â”‚   â”‚   â”œâ”€â”€ FileUpload.vue
â”‚   â”‚   â””â”€â”€ MarkdownViewer.vue
â”‚   â”œâ”€â”€ views/                           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Chat.vue
â”‚   â”‚   â”œâ”€â”€ Knowledge.vue
â”‚   â”‚   â””â”€â”€ Settings.vue
â”‚   â”œâ”€â”€ api/                             # APIæ¥å£
â”‚   â”œâ”€â”€ stores/                          # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/                           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ types/                           # TypeScriptç±»å‹
â”‚   â””â”€â”€ router/                          # è·¯ç”±é…ç½®
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ tsconfig.json
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. RAGé—®ç­”æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·æé—®] --> B[é—®é¢˜é¢„å¤„ç†]
    B --> C[æ–‡æœ¬å‘é‡åŒ–]
    C --> D[Milvuså‘é‡æ£€ç´¢]
    D --> E[æ„å»ºPrompt]
    E --> F[DeepSeekç”Ÿæˆç­”æ¡ˆ]
    F --> G[åå¤„ç†ä¼˜åŒ–]
    G --> H[è¿”å›ç”¨æˆ·]
    H --> I[ä¿å­˜å¯¹è¯å†å²]
```

### 2. çŸ¥è¯†åº“ç®¡ç†æµç¨‹

```mermaid
graph TD
    A[ä¸Šä¼ æ–‡æ¡£] --> B[æ–‡ä»¶è§£æ]
    B --> C[æ–‡æœ¬åˆ†å—]
    C --> D[å‘é‡åŒ–å¤„ç†]
    D --> E[å­˜å‚¨Milvus]
    E --> F[ä¿å­˜å…ƒæ•°æ®]
    F --> G[ç´¢å¼•å®Œæˆ]
```

### 3. å…³é”®ä»£ç ç¤ºä¾‹

#### 3.1 RAGé—®ç­”æœåŠ¡

```java
@Service
public class ChatService {
    
    @Autowired
    private AiService aiService;
    
    @Autowired
    private MilvusService milvusService;
    
    @Autowired
    private MessageMapper messageMapper;
    
    public ChatResponse sendMessage(ChatRequest request) {
        // 1. å‘é‡åŒ–ç”¨æˆ·é—®é¢˜
        float[] questionVector = aiService.getTextEmbedding(request.getMessage());
        
        // 2. Milvusæ£€ç´¢ç›¸å…³æ–‡æ¡£
        List<SearchResult> searchResults = milvusService.search(
            questionVector, 
            5,  // Top-K
            0.7f // ç›¸ä¼¼åº¦é˜ˆå€¼
        );
        
        // 3. æ„å»ºPrompt
        String context = buildContext(searchResults);
        String prompt = buildPrompt(context, request.getMessage());
        
        // 4. è°ƒç”¨DeepSeekç”Ÿæˆç­”æ¡ˆ
        String answer = aiService.generateAnswer(prompt);
        
        // 5. ä¿å­˜æ¶ˆæ¯è®°å½•
        saveMessage(request.getConversationId(), "USER", request.getMessage());
        saveMessage(request.getConversationId(), "BOT", answer);
        
        // 6. è¿”å›ç»“æœ
        return ChatResponse.builder()
            .answer(answer)
            .sources(searchResults)
            .build();
    }
    
    private String buildContext(List<SearchResult> results) {
        StringBuilder context = new StringBuilder();
        for (SearchResult result : results) {
            context.append(result.getContent()).append("\n\n");
        }
        return context.toString();
    }
    
    private String buildPrompt(String context, String question) {
        return String.format(
            "ä½ æ˜¯ä¸€åä¸“ä¸šçš„ITçŸ¥è¯†é—®ç­”åŠ©æ‰‹ã€‚è¯·åŸºäºä»¥ä¸‹æä¾›çš„å‚è€ƒèµ„æ–™,å‡†ç¡®ã€ç®€æ´åœ°å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚\n\n" +
            "å‚è€ƒèµ„æ–™:\n%s\n\n" +
            "ç”¨æˆ·é—®é¢˜: %s\n\n" +
            "å›ç­”è¦æ±‚:\n" +
            "1. åªä½¿ç”¨å‚è€ƒèµ„æ–™ä¸­çš„ä¿¡æ¯\n" +
            "2. å¦‚æœé—®é¢˜ä¸å‚è€ƒèµ„æ–™æ— å…³,è¯·è¯´æ˜\"æŠ±æ­‰,æˆ‘æš‚æ—¶æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜\"\n" +
            "3. è¯­è¨€ç®€æ´æ¸…æ™°,é¿å…å†—é•¿\n" +
            "4. å¯ä»¥é€‚å½“ä½¿ç”¨åˆ—è¡¨ã€ä»£ç å—ç­‰æ ¼å¼\n\n" +
            "å›ç­”:",
            context, question
        );
    }
}
```

#### 3.2 AIæœåŠ¡å®ç°

```java
@Service
public class AiService {
    
    @Value("${ai.aliyun.access-key}")
    private String aliyunAccessKey;
    
    @Value("${ai.aliyun.secret-key}")
    private String aliyunSecretKey;
    
    @Value("${ai.aliyun.embedding-endpoint}")
    private String embeddingEndpoint;
    
    @Value("${ai.aliyun.model:text-embedding-v3}")
    private String embeddingModel;
    
    @Value("${ai.deepseek.api-key}")
    private String deepseekApiKey;
    
    @Value("${ai.deepseek.api-url}")
    private String deepseekApiUrl;
    
    @Value("${ai.deepseek.model:deepseek-v3.2}")
    private String deepseekModel;
    
    private final HttpClient httpClient;
    
    public AiService() {
        this.httpClient = HttpClient.newBuilder()
            .connectTimeout(Duration.ofSeconds(30))
            .build();
    }
    
    /**
     * è·å–æ–‡æœ¬çš„Embeddingå‘é‡(é˜¿é‡Œäº‘Qwen3-Embedding)
     */
    public float[] getTextEmbedding(String text) {
        try {
            Map<String, Object> requestBody = new HashMap<>();
            requestBody.put("model", embeddingModel);
            requestBody.put("input", Map.of("texts", List.of(text)));
            
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(embeddingEndpoint))
                .header("Authorization", "Bearer " + aliyunAccessKey)
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(new ObjectMapper().writeValueAsString(requestBody)))
                .build();
            
            HttpResponse<String> response = httpClient.send(
                request, 
                HttpResponse.BodyHandlers.ofString()
            );
            
            JsonNode rootNode = new ObjectMapper().readTree(response.body());
            JsonNode embeddings = rootNode.path("output").path("embeddings");
            
            if (embeddings.isArray() && embeddings.size() > 0) {
                JsonNode embedding = embeddings.get(0).path("embedding");
                float[] vector = new float[embedding.size()];
                for (int i = 0; i < embedding.size(); i++) {
                    vector[i] = (float) embedding.get(i).asDouble();
                }
                return vector;
            }
            
            throw new RuntimeException("Failed to get embedding: " + response.body());
            
        } catch (Exception e) {
            log.error("Failed to get text embedding", e);
            throw new RuntimeException("Failed to get text embedding", e);
        }
    }
    
    /**
     * æ‰¹é‡è·å–æ–‡æœ¬çš„Embeddingå‘é‡
     */
    public List<float[]> getTextEmbeddings(List<String> texts) {
        try {
            Map<String, Object> requestBody = new HashMap<>();
            requestBody.put("model", embeddingModel);
            requestBody.put("input", Map.of("texts", texts));
            
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(embeddingEndpoint))
                .header("Authorization", "Bearer " + aliyunAccessKey)
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(new ObjectMapper().writeValueAsString(requestBody)))
                .build();
            
            HttpResponse<String> response = httpClient.send(
                request, 
                HttpResponse.BodyHandlers.ofString()
            );
            
            JsonNode rootNode = new ObjectMapper().readTree(response.body());
            JsonNode embeddings = rootNode.path("output").path("embeddings");
            
            List<float[]> vectors = new ArrayList<>();
            if (embeddings.isArray()) {
                for (JsonNode embeddingNode : embeddings) {
                    JsonNode embedding = embeddingNode.path("embedding");
                    float[] vector = new float[embedding.size()];
                    for (int i = 0; i < embedding.size(); i++) {
                        vector[i] = (float) embedding.get(i).asDouble();
                    }
                    vectors.add(vector);
                }
            }
            
            return vectors;
            
        } catch (Exception e) {
            log.error("Failed to get text embeddings", e);
            throw new RuntimeException("Failed to get text embeddings", e);
        }
    }
    
    /**
     * è°ƒç”¨DeepSeekç”Ÿæˆç­”æ¡ˆ
     */
    public String generateAnswer(String prompt) {
        try {
            Map<String, Object> requestBody = new HashMap<>();
            requestBody.put("model", deepseekModel);
            requestBody.put("messages", List.of(
                Map.of("role", "user", "content", prompt)
            ));
            requestBody.put("temperature", 0.7);
            requestBody.put("max_tokens", 1000);
            
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(deepseekApiUrl))
                .header("Authorization", "Bearer " + deepseekApiKey)
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(new ObjectMapper().writeValueAsString(requestBody)))
                .build();
            
            HttpResponse<String> response = httpClient.send(
                request, 
                HttpResponse.BodyHandlers.ofString()
            );
            
            JsonNode rootNode = new ObjectMapper().readTree(response.body());
            JsonNode choices = rootNode.path("choices");
            
            if (choices.isArray() && choices.size() > 0) {
                return choices.get(0).path("message").path("content").asText();
            }
            
            throw new RuntimeException("Failed to generate answer: " + response.body());
            
        } catch (Exception e) {
            log.error("Failed to generate answer", e);
            throw new RuntimeException("Failed to generate answer", e);
        }
    }
}
```

#### 3.3 çŸ¥è¯†åº“æ–‡æ¡£å¤„ç†

```java
@Service
public class KnowledgeService {
    
    @Autowired
    private AiService aiService;
    
    @Autowired
    private MilvusService milvusService;
    
    @Autowired
    private KnowledgeDocMapper docMapper;
    
    @Autowired
    private KnowledgeChunkMapper chunkMapper;
    
    @Autowired
    private DocumentParserFactory parserFactory;
    
    @Autowired
    private TextChunkingService chunkingService;
    
    @Async
    public void processDocument(Long docId) {
        try {
            log.info("å¼€å§‹å¤„ç†æ–‡æ¡£: docId={}", docId);
            
            // 1. è·å–æ–‡æ¡£
            KnowledgeDoc doc = docMapper.selectById(docId);
            
            // 2. æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©è§£æå™¨
            DocumentParser parser = parserFactory.getParser(doc.getFileType());
            String content = parser.parse(doc.getFilePath());
            
            log.info("æ–‡æ¡£è§£æå®Œæˆï¼Œæ–‡æœ¬é•¿åº¦: {}", content.length());
            
            // 3. ä½¿ç”¨LangChain4jè¿›è¡Œæ™ºèƒ½åˆ†å‰²
            List<TextSegment> segments = chunkingService.smartSplit(
                content, 
                doc.getFileType()
            );
            
            log.info("æ–‡æ¡£åˆ†å‰²å®Œæˆï¼Œç”Ÿæˆ {} ä¸ªchunks", segments.size());
            
            // 4. æ‰¹é‡å‘é‡åŒ–
            List<String> texts = segments.stream()
                .map(TextSegment::text)
                .collect(Collectors.toList());
            
            List<float[]> vectors = aiService.getTextEmbeddings(texts);
            
            log.info("å‘é‡åŒ–å®Œæˆï¼Œç”Ÿæˆ {} ä¸ªå‘é‡", vectors.size());
            
            // 5. å­˜å‚¨åˆ°Milvus
            List<String> vectorIds = milvusService.insertVectors(vectors);
            
            // 6. ä¿å­˜åˆ†å—ä¿¡æ¯åˆ°æ•°æ®åº“
            for (int i = 0; i < segments.size(); i++) {
                KnowledgeChunk chunk = new KnowledgeChunk();
                chunk.setDocId(docId);
                chunk.setChunkIndex(i);
                chunk.setChunkType("TEXT");
                chunk.setContent(segments.get(i).text());
                chunk.setVectorId(vectorIds.get(i));
                chunk.setTokenCount(segments.get(i).text().length());
                chunk.setMetadata(buildChunkMetadata(segments.get(i), i));
                chunkMapper.insert(chunk);
            }
            
            // 7. æ›´æ–°æ–‡æ¡£çŠ¶æ€
            doc.setStatus(DocStatus.COMPLETED);
            doc.setVectorCount(segments.size());
            docMapper.updateById(doc);
            
            log.info("æ–‡æ¡£å¤„ç†å®Œæˆ: docId={}, chunkCount={}", docId, segments.size());
            
        } catch (Exception e) {
            log.error("Failed to process document: {}", docId, e);
            // æ›´æ–°å¤±è´¥çŠ¶æ€
            KnowledgeDoc doc = new KnowledgeDoc();
            doc.setId(docId);
            doc.setStatus(DocStatus.FAILED);
            doc.setProcessMessage(e.getMessage());
            docMapper.updateById(doc);
        }
    }
    
    /**
     * æ„å»ºchunkå…ƒæ•°æ®
     */
    private String buildChunkMetadata(TextSegment segment, int index) {
        StringBuilder metadata = new StringBuilder();
        metadata.append("{");
        metadata.append("\"chunkIndex\":").append(index).append(",");
        metadata.append("\"length\":").append(segment.text().length());
        metadata.append("}");
        return metadata.toString();
    }
}

/**
 * æ–‡æœ¬åˆ‡å—æœåŠ¡
 */
@Service
public class TextChunkingService {
    
    @Value("${chunking.strategy:recursive}")
    private String strategy;
    
    @Value("${chunking.max-size:500}")
    private int maxChunkSize;
    
    @Value("${chunking.overlap-size:50}")
    private int overlapSize;
    
    @Value("${chunking.min-chunk-size:1}")
    private int minChunkSize;
    
    /**
     * æ™ºèƒ½åˆ†å‰²ï¼ˆæ ¹æ®æ–‡æœ¬ç±»å‹é€‰æ‹©ç­–ç•¥ï¼‰
     */
    public List<TextSegment> smartSplit(String text, String documentType) {
        Document document = Document.from(text);
        DocumentSplitter splitter = getSplitterForFileType(documentType);
        return splitter.split(document);
    }
    
    /**
     * æ ¹æ®æ–‡ä»¶ç±»å‹è·å–åˆ†å‰²å™¨
     */
    private DocumentSplitter getSplitterForFileType(String fileType) {
        switch (fileType.toLowerCase()) {
            case "pdf":
            case "md":
            case "docx":
            case "ppt":
            case "pptx":
                // æ–‡æ¡£ç±»å‹ï¼šä½¿ç”¨é€’å½’åˆ†å‰²
                return DocumentSplitters.recursive(
                    maxChunkSize,
                    overlapSize,
                    minChunkSize,
                    "\n\n", "\n", "ã€‚", "ï¼", "ï¼Ÿ", ".", "!", "?", " ", ""
                );
            case "txt":
                // çº¯æ–‡æœ¬ï¼šæŒ‰æ®µè½åˆ†å‰²
                return DocumentSplitters.byParagraph(maxChunkSize, overlapSize, minChunkSize);
            case "code":
                // ä»£ç ï¼šæŒ‰è¡Œåˆ†å‰²
                return DocumentSplitters.byLine(maxChunkSize, overlapSize, minChunkSize);
            default:
                // é»˜è®¤ï¼šé€’å½’åˆ†å‰²
                return DocumentSplitters.recursive(
                    maxChunkSize,
                    overlapSize,
                    minChunkSize,
                    "\n\n", "\n", "ã€‚", "ï¼", "ï¼Ÿ", ".", "!", "?", " ", ""
                );
        }
    }
}
```

## ğŸ§ª æµ‹è¯•æ–¹æ¡ˆ

### 1. å•å…ƒæµ‹è¯•

```java
@SpringBootTest
public class ChatServiceTest {
    
    @Autowired
    private ChatService chatService;
    
    @Test
    @DisplayName("æµ‹è¯•RAGé—®ç­”")
    public void testRagQa() {
        // Given
        ChatRequest request = new ChatRequest();
        request.setMessage("ä»€ä¹ˆæ˜¯Spring Boot?");
        
        // When
        ChatResponse response = chatService.sendMessage(request);
        
        // Then
        assertNotNull(response);
        assertNotNull(response.getAnswer());
        assertTrue(response.getAnswer().contains("Spring"));
        assertTrue(response.getSources().size() > 0);
    }
}
```

### 2. APIæµ‹è¯•

ä½¿ç”¨Postmanæˆ–Apifoxæµ‹è¯•APIæ¥å£:

```http
### å‘é€æ¶ˆæ¯
POST http://localhost:8080/api/v1/chat/message
Content-Type: application/json
Authorization: Bearer your_token

{
  "message": "ä»€ä¹ˆæ˜¯Java?"
}

### è·å–å¯¹è¯åˆ—è¡¨
GET http://localhost:8080/api/v1/chat/conversations
Authorization: Bearer your_token
```

### 3. å‰ç«¯æµ‹è¯•

```typescript
// ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
import { mount } from '@vue/test-utils'
import ChatMessage from '@/components/ChatMessage.vue'

describe('ChatMessage.vue', () => {
  it('renders user message correctly', () => {
    const wrapper = mount(ChatMessage, {
      props: {
        senderType: 'USER',
        content: 'Hello, AI!',
        createdAt: '2024-01-01T00:00:00Z'
      }
    })
    
    expect(wrapper.text()).toContain('Hello, AI!')
    expect(wrapper.classes()).toContain('USER')
  })
})
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
- ä½¿ç”¨è¿æ¥æ± ä¼˜åŒ–æ•°æ®åº“è¿æ¥
- å®šæœŸæ¸…ç†å†å²æ•°æ®

### 2. ç¼“å­˜ç­–ç•¥
- Redisç¼“å­˜çƒ­ç‚¹çŸ¥è¯†åº“å†…å®¹
- æœ¬åœ°ç¼“å­˜ç”¨æˆ·ä¼šè¯ä¿¡æ¯
- CDNåŠ é€Ÿé™æ€èµ„æº

### 3. AIè°ƒç”¨ä¼˜åŒ–
- æ‰¹é‡å‘é‡åŒ–å¤„ç†
- å¼‚æ­¥å¤„ç†æ–‡æ¡£ç´¢å¼•
- è¯·æ±‚é‡è¯•æœºåˆ¶

### 4. å‰ç«¯ä¼˜åŒ–
- æ‡’åŠ è½½ç»„ä»¶
- è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–é•¿åˆ—è¡¨
- å›¾ç‰‡å’Œèµ„æºå‹ç¼©

## ğŸ” ç›‘æ§ä¸æ—¥å¿—

### 1. æ—¥å¿—é…ç½®

```yaml
logging:
  level:
    com.example.itqabot: INFO
    io.milvus: WARN
  file:
    name: logs/it-qabot.log
    max-size: 100MB
    max-history: 30
```

### 2. ç›‘æ§æŒ‡æ ‡
- APIå“åº”æ—¶é—´
- AIè°ƒç”¨æ¬¡æ•°å’Œè€—æ—¶
- æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡

### 3. å¥åº·æ£€æŸ¥

```java
@RestController
public class HealthController {
    
    @GetMapping("/health")
    public Map<String, Object> health() {
        Map<String, Object> health = new HashMap<>();
        health.put("status", "UP");
        health.put("timestamp", LocalDateTime.now());
        health.put("version", "1.0.0");
        return health;
    }
}
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥PostgreSQLæ˜¯å¦å¯åŠ¨
- éªŒè¯æ•°æ®åº“è¿æ¥é…ç½®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### 2. Milvusè¿æ¥å¤±è´¥
- ç¡®è®¤MilvusæœåŠ¡çŠ¶æ€
- æ£€æŸ¥ç«¯å£æ˜¯å¦å¼€æ”¾
- éªŒè¯é›†åˆæ˜¯å¦å­˜åœ¨

### 3. AIæ¥å£è°ƒç”¨å¤±è´¥
- æ£€æŸ¥APIå¯†é’¥é…ç½®
- éªŒè¯ç½‘ç»œè¿æ¥
- æŸ¥çœ‹APIé…é¢å’Œé™åˆ¶

### 4. å‰ç«¯æ„å»ºå¤±è´¥
- æ£€æŸ¥Node.jsç‰ˆæœ¬
- æ¸…ç†node_modulesé‡æ–°å®‰è£…
- æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®

## ğŸ“š å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Spring Bootå®˜æ–¹æ–‡æ¡£](https://spring.io/projects/spring-boot)
- [Vue.js 3å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Element Plusç»„ä»¶åº“](https://element-plus.org/)
- [Milvuså‘é‡æ•°æ®åº“](https://milvus.io/)

### æŠ€æœ¯åšå®¢
- [RAGæŠ€æœ¯è¯¦è§£](https://www.pinecone.io/learn/retrieval-augmented-generation/)
- [Spring Bootæœ€ä½³å®è·µ](https://www.baeldung.com/spring-boot)
- [Vue 3ç»„åˆå¼API](https://vuejs.org/guide/extras/composition-api-faq.html)

### è§†é¢‘æ•™ç¨‹
- Spring Bootå…¥é—¨åˆ°ç²¾é€š
- Vue 3 + TypeScriptå®æˆ˜
- å‘é‡æ•°æ®åº“Milvusä½¿ç”¨æŒ‡å—

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Forké¡¹ç›®åˆ°ä¸ªäººä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ
- éµå¾ªJavaå’ŒTypeScriptç¼–ç è§„èŒƒ
- ç¼–å†™å•å…ƒæµ‹è¯•
- æ›´æ–°ç›¸å…³æ–‡æ¡£
- é€šè¿‡Code Review

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- ğŸ“§ Email: support@example.com
- ğŸ’¬ å¾®ä¿¡ç¾¤: ITçŸ¥è¯†é—®ç­”æœºå™¨äººæŠ€æœ¯ç¾¤
- ğŸ› Issueåé¦ˆ: https://github.com/yourusername/it-qabot/issues

### æ›´æ–°æ—¥å¿—
æŸ¥çœ‹ [CHANGELOG.md](CHANGELOG.md) äº†è§£ç‰ˆæœ¬æ›´æ–°å†…å®¹ã€‚

---

**ç¥æ‚¨å¼€å‘æ„‰å¿«!** ğŸ‰
