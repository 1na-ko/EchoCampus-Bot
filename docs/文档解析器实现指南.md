# æ–‡æ¡£è§£æå™¨å®ç°æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†ITçŸ¥è¯†é—®ç­”æœºå™¨äººé¡¹ç›®ä¸­å„ç§æ–‡æ¡£æ ¼å¼çš„è§£æå™¨å®ç°ï¼ŒåŒ…æ‹¬PDFã€TXTã€MDã€DOCXã€PPTã€PPTXç­‰æ ¼å¼çš„è§£ææ–¹æ¡ˆã€‚

## ğŸ¯ æ”¯æŒçš„æ–‡æ¡£æ ¼å¼

| æ ¼å¼ | æ‰©å±•å | è§£æåº“ | Chunkingç­–ç•¥ |
|-----|-------|--------|-------------|
| PDF | .pdf | Apache PDFBox | é€’å½’åˆ†å‰²(800-1000å­—ç¬¦) |
| TXT | .txt | JavaåŸç”ŸAPI | æŒ‰æ®µè½åˆ†å‰²(500-800å­—ç¬¦) |
| Markdown | .md | Flexmark + Jsoup | é€’å½’åˆ†å‰²(600-900å­—ç¬¦) |
| Word | .docx, .doc | Apache POI | é€’å½’åˆ†å‰²(700-900å­—ç¬¦) |
| PowerPoint | .pptx, .ppt | Apache POI | é€’å½’åˆ†å‰²(400-600å­—ç¬¦) |

## ğŸ“¦ ä¾èµ–é…ç½®

### Mavenä¾èµ–ï¼ˆpom.xmlï¼‰

```xml
<dependencies>
    <!-- LangChain4jæ ¸å¿ƒ -->
    <dependency>
        <groupId>dev.langchain4j</groupId>
        <artifactId>langchain4j</artifactId>
        <version>0.27.1</version>
    </dependency>
    
    <!-- LangChain4jæ–‡æ¡£åˆ†å‰²å™¨ -->
    <dependency>
        <groupId>dev.langchain4j</groupId>
        <artifactId>langchain4j-document-splitter</artifactId>
        <version>0.27.1</version>
    </dependency>
    
    <!-- PDFè§£æ -->
    <dependency>
        <groupId>org.apache.pdfbox</groupId>
        <artifactId>pdfbox</artifactId>
        <version>2.0.29</version>
    </dependency>
    
    <!-- Wordæ–‡æ¡£è§£æ -->
    <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml</artifactId>
        <version>5.2.3</version>
    </dependency>
    
    <!-- PowerPointæ–‡æ¡£è§£æ -->
    <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml-full</artifactId>
        <version>5.2.3</version>
    </dependency>
    
    <!-- Markdownè§£æ -->
    <dependency>
        <groupId>com.vladsch.flexmark</groupId>
        <artifactId>flexmark-all</artifactId>
        <version>0.64.8</version>
    </dependency>
    
    <!-- HTMLè§£æ -->
    <dependency>
        <groupId>org.jsoup</groupId>
        <artifactId>jsoup</artifactId>
        <version>1.16.1</version>
    </dependency>
</dependencies>
```

## ğŸ”§ æ–‡æ¡£è§£æå™¨æ¥å£è®¾è®¡

### 1. æ–‡æ¡£è§£æå™¨æ¥å£

```java
package com.example.itqabot.parser;

import com.example.itqabot.dto.DocumentMetadata;

/**
 * æ–‡æ¡£è§£æå™¨æ¥å£
 */
public interface DocumentParser {
    
    /**
     * è§£ææ–‡æ¡£ï¼Œæå–æ–‡æœ¬å†…å®¹
     * 
     * @param filePath æ–‡ä»¶è·¯å¾„
     * @return æå–çš„æ–‡æœ¬å†…å®¹
     * @throws DocumentParseException è§£æå¼‚å¸¸
     */
    String parse(String filePath) throws DocumentParseException;
    
    /**
     * è·å–æ–‡æ¡£å…ƒæ•°æ®
     * 
     * @param filePath æ–‡ä»¶è·¯å¾„
     * @return æ–‡æ¡£å…ƒæ•°æ®
     * @throws DocumentParseException è§£æå¼‚å¸¸
     */
    DocumentMetadata getMetadata(String filePath) throws DocumentParseException;
    
    /**
     * æ”¯æŒçš„æ–‡ä»¶ç±»å‹
     * 
     * @return æ–‡ä»¶ç±»å‹åˆ—è¡¨ï¼ˆå¦‚ ["pdf", "txt", "md"]ï¼‰
     */
    List<String> getSupportedTypes();
}
```

### 2. æ–‡æ¡£å…ƒæ•°æ®DTO

```java
package com.example.itqabot.dto;

import lombok.Builder;
import lombok.Data;

@Data
@Builder
public class DocumentMetadata {
    private String title;
    private String author;
    private String subject;
    private String keywords;
    private Integer pageCount;
    private Integer slideCount;
    private Long fileSize;
    private String createdDate;
    private String modifiedDate;
}
```

### 3. æ–‡æ¡£è§£æå¼‚å¸¸

```java
package com.example.itqabot.exception;

public class DocumentParseException extends Exception {
    
    public DocumentParseException(String message) {
        super(message);
    }
    
    public DocumentParseException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

## ğŸ“„ PDFè§£æå™¨å®ç°

```java
package com.example.itqabot.parser.impl;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.pdmodel.PDDocumentInformation;
import org.apache.pdfbox.text.PDFTextStripper;
import org.springframework.stereotype.Component;

import java.io.File;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;

@Slf4j
@Component
public class PdfDocumentParser implements DocumentParser {
    
    @Override
    public String parse(String filePath) throws DocumentParseException {
        try (PDDocument document = PDDocument.load(new File(filePath))) {
            PDFTextStripper stripper = new PDFTextStripper();
            
            stripper.setSortByPosition(true);
            stripper.setLineSeparator("\n");
            stripper.setParagraphStart("\n\n");
            stripper.setParagraphEnd("\n\n");
            
            String text = stripper.getText(document);
            
            log.info("PDFè§£ææˆåŠŸ: æ–‡ä»¶={}, é¡µæ•°={}, æ–‡æœ¬é•¿åº¦={}", 
                filePath, document.getNumberOfPages(), text.length());
            
            return cleanText(text);
            
        } catch (IOException e) {
            log.error("PDFè§£æå¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("PDFè§£æå¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public DocumentMetadata getMetadata(String filePath) throws DocumentParseException {
        try (PDDocument document = PDDocument.load(new File(filePath))) {
            PDDocumentInformation info = document.getDocumentInformation();
            
            return DocumentMetadata.builder()
                .title(info.getTitle())
                .author(info.getAuthor())
                .subject(info.getSubject())
                .keywords(info.getKeywords())
                .pageCount(document.getNumberOfPages())
                .fileSize(new File(filePath).length())
                .createdDate(info.getCreationDate())
                .modifiedDate(info.getModificationDate())
                .build();
                
        } catch (IOException e) {
            log.error("è·å–PDFå…ƒæ•°æ®å¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("è·å–PDFå…ƒæ•°æ®å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public List<String> getSupportedTypes() {
        return Arrays.asList("pdf");
    }
    
    /**
     * æ¸…ç†æ–‡æœ¬å†…å®¹
     */
    private String cleanText(String text) {
        if (text == null || text.isEmpty()) {
            return "";
        }
        
        text = text.replaceAll("\\r\\n", "\n");
        text = text.replaceAll("\\s+", " ");
        text = text.replaceAll("[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]", "");
        text = text.trim();
        
        return text;
    }
}
```

## ğŸ“ TXTè§£æå™¨å®ç°

```java
package com.example.itqabot.parser.impl;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Component;

import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.Arrays;
import java.util.List;

@Slf4j
@Component
public class TxtDocumentParser implements DocumentParser {
    
    @Override
    public String parse(String filePath) throws DocumentParseException {
        try {
            String content = Files.readString(Paths.get(filePath), StandardCharsets.UTF_8);
            
            log.info("TXTè§£ææˆåŠŸ: æ–‡ä»¶={}, æ–‡æœ¬é•¿åº¦={}", filePath, content.length());
            
            return content;
            
        } catch (IOException e) {
            log.error("TXTè§£æå¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("TXTè§£æå¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public DocumentMetadata getMetadata(String filePath) throws DocumentParseException {
        try {
            Path path = Paths.get(filePath);
            
            return DocumentMetadata.builder()
                .title(path.getFileName().toString())
                .fileSize(Files.size(path))
                .build();
                
        } catch (IOException e) {
            log.error("è·å–TXTå…ƒæ•°æ®å¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("è·å–TXTå…ƒæ•°æ®å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public List<String> getSupportedTypes() {
        return Arrays.asList("txt");
    }
}
```

## ğŸ“„ Markdownè§£æå™¨å®ç°

```java
package com.example.itqabot.parser.impl;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.parser.DocumentParser;
import com.vladsch.flexmark.html.HtmlRenderer;
import com.vladsch.flexmark.parser.Parser;
import com.vladsch.flexmark.util.ast.Document;
import lombok.extern.slf4j.Slf4j;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import org.springframework.stereotype.Component;

import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Arrays;
import java.util.List;

@Slf4j
@Component
public class MarkdownDocumentParser implements DocumentParser {
    
    private final Parser parser = Parser.builder().build();
    private final HtmlRenderer renderer = HtmlRenderer.builder().build();
    
    @Override
    public String parse(String filePath) throws DocumentParseException {
        try {
            String content = Files.readString(Paths.get(filePath), StandardCharsets.UTF_8);
            
            Document document = parser.parse(content);
            String html = renderer.render(document);
            
            String text = extractTextFromHtml(html);
            
            log.info("Markdownè§£ææˆåŠŸ: æ–‡ä»¶={}, æ–‡æœ¬é•¿åº¦={}", filePath, text.length());
            
            return text;
            
        } catch (Exception e) {
            log.error("Markdownè§£æå¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("Markdownè§£æå¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public DocumentMetadata getMetadata(String filePath) throws DocumentParseException {
        try {
            String content = Files.readString(Paths.get(filePath), StandardCharsets.UTF_8);
            
            String title = extractTitle(content);
            
            return DocumentMetadata.builder()
                .title(title)
                .fileSize(new java.io.File(filePath).length())
                .build();
                
        } catch (Exception e) {
            log.error("è·å–Markdownå…ƒæ•°æ®å¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("è·å–Markdownå…ƒæ•°æ®å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public List<String> getSupportedTypes() {
        return Arrays.asList("md");
    }
    
    /**
     * ä»HTMLä¸­æå–çº¯æ–‡æœ¬
     */
    private String extractTextFromHtml(String html) {
        org.jsoup.nodes.Document doc = Jsoup.parse(html);
        
        Elements codeBlocks = doc.select("pre code");
        codeBlocks.forEach(block -> block.text("[ä»£ç å—]"));
        
        return doc.text();
    }
    
    /**
     * ä»Markdownä¸­æå–æ ‡é¢˜
     */
    private String extractTitle(String content) {
        String[] lines = content.split("\n");
        for (String line : lines) {
            if (line.startsWith("# ")) {
                return line.substring(2).trim();
            }
        }
        return "æœªå‘½åæ–‡æ¡£";
    }
}
```

## ğŸ“„ DOCXè§£æå™¨å®ç°

```java
package com.example.itqabot.parser.impl;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.apache.poi.xwpf.usermodel.XWPFDocument;
import org.apache.poi.xwpf.usermodel.XWPFParagraph;
import org.apache.poi.xwpf.usermodel.XWPFTable;
import org.apache.poi.xwpf.usermodel.XWPFTableCell;
import org.apache.poi.xwpf.usermodel.XWPFTableRow;
import org.springframework.stereotype.Component;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;

@Slf4j
@Component
public class DocxDocumentParser implements DocumentParser {
    
    @Override
    public String parse(String filePath) throws DocumentParseException {
        try (FileInputStream fis = new FileInputStream(filePath);
             XWPFDocument document = new XWPFDocument(fis)) {
            
            StringBuilder text = new StringBuilder();
            
            for (XWPFParagraph paragraph : document.getParagraphs()) {
                String paragraphText = paragraph.getText();
                if (!paragraphText.isEmpty()) {
                    text.append(paragraphText).append("\n");
                }
            }
            
            for (XWPFTable table : document.getTables()) {
                for (XWPFTableRow row : table.getRows()) {
                    for (XWPFTableCell cell : row.getTableCells()) {
                        text.append(cell.getText()).append("\t");
                    }
                    text.append("\n");
                }
                text.append("\n");
            }
            
            log.info("DOCXè§£ææˆåŠŸ: æ–‡ä»¶={}, æ–‡æœ¬é•¿åº¦={}", filePath, text.length());
            
            return text.toString().trim();
            
        } catch (IOException e) {
            log.error("DOCXè§£æå¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("DOCXè§£æå¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public DocumentMetadata getMetadata(String filePath) throws DocumentParseException {
        try (FileInputStream fis = new FileInputStream(filePath);
             XWPFDocument document = new XWPFDocument(fis)) {
            
            String title = document.getProperties().getCoreProperties()
                .getTitle();
            
            if (title == null || title.isEmpty()) {
                title = new java.io.File(filePath).getName();
            }
            
            return DocumentMetadata.builder()
                .title(title)
                .author(document.getProperties().getCoreProperties().getCreator())
                .fileSize(new java.io.File(filePath).length())
                .build();
                
        } catch (IOException e) {
            log.error("è·å–DOCXå…ƒæ•°æ®å¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("è·å–DOCXå…ƒæ•°æ®å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public List<String> getSupportedTypes() {
        return Arrays.asList("docx", "doc");
    }
}
```

## ğŸ“Š PPT/PPTXè§£æå™¨å®ç°

```java
package com.example.itqabot.parser.impl;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.apache.poi.xslf.usermodel.XMLSlideShow;
import org.apache.poi.xslf.usermodel.XSLFShape;
import org.apache.poi.xslf.usermodel.XSLFSlide;
import org.apache.poi.xslf.usermodel.XSLFTextParagraph;
import org.apache.poi.xslf.usermodel.XSLFTextRun;
import org.apache.poi.xslf.usermodel.XSLFTextShape;
import org.springframework.stereotype.Component;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;

@Slf4j
@Component
public class PptDocumentParser implements DocumentParser {
    
    @Override
    public String parse(String filePath) throws DocumentParseException {
        try (FileInputStream fis = new FileInputStream(filePath);
             XMLSlideShow ppt = new XMLSlideShow(fis)) {
            
            StringBuilder text = new StringBuilder();
            
            List<XSLFSlide> slides = ppt.getSlides();
            
            for (int i = 0; i < slides.size(); i++) {
                XSLFSlide slide = slides.get(i);
                
                text.append("=== å¹»ç¯ç‰‡ ").append(i + 1).append(" ===\n");
                
                for (XSLFShape shape : slide.getShapes()) {
                    if (shape instanceof XSLFTextShape) {
                        XSLFTextShape textShape = (XSLFTextShape) shape;
                        
                        for (XSLFTextParagraph paragraph : textShape.getTextParagraphs()) {
                            String paragraphText = paragraph.getText();
                            if (!paragraphText.isEmpty()) {
                                text.append(paragraphText).append("\n");
                            }
                        }
                    }
                }
                
                text.append("\n");
            }
            
            log.info("PPTè§£ææˆåŠŸ: æ–‡ä»¶={}, å¹»ç¯ç‰‡æ•°={}, æ–‡æœ¬é•¿åº¦={}", 
                filePath, slides.size(), text.length());
            
            return text.toString().trim();
            
        } catch (IOException e) {
            log.error("PPTè§£æå¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("PPTè§£æå¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public DocumentMetadata getMetadata(String filePath) throws DocumentParseException {
        try (FileInputStream fis = new FileInputStream(filePath);
             XMLSlideShow ppt = new XMLSlideShow(fis)) {
            
            String title = ppt.getSlideMasters().get(0)
                .getTheme().getXmlObject().getThemeManager()
                .getThemeXml().getName();
            
            return DocumentMetadata.builder()
                .title(title)
                .slideCount(ppt.getSlides().size())
                .fileSize(new java.io.File(filePath).length())
                .build();
                
        } catch (IOException e) {
            log.error("è·å–PPTå…ƒæ•°æ®å¤±è´¥: {}", filePath, e);
            throw new DocumentParseException("è·å–PPTå…ƒæ•°æ®å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    @Override
    public List<String> getSupportedTypes() {
        return Arrays.asList("pptx", "ppt");
    }
}
```

## ğŸ­ æ–‡æ¡£è§£æå™¨å·¥å‚

```java
package com.example.itqabot.factory;

import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.function.Function;
import java.util.stream.Collectors;

@Slf4j
@Component
public class DocumentParserFactory {
    
    private final Map<String, DocumentParser> parserMap;
    
    @Autowired
    public DocumentParserFactory(List<DocumentParser> parsers) {
        this.parserMap = parsers.stream()
            .collect(Collectors.toMap(
                parser -> parser.getSupportedTypes().get(0),
                Function.identity()
            ));
        
        log.info("æ–‡æ¡£è§£æå™¨åˆå§‹åŒ–å®Œæˆï¼Œæ”¯æŒæ ¼å¼: {}", parserMap.keySet());
    }
    
    /**
     * æ ¹æ®æ–‡ä»¶ç±»å‹è·å–è§£æå™¨
     */
    public DocumentParser getParser(String fileType) {
        String type = fileType.toLowerCase();
        
        DocumentParser parser = parserMap.get(type);
        if (parser == null) {
            throw new UnsupportedOperationException("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: " + fileType);
        }
        
        log.debug("ä½¿ç”¨è§£æå™¨: {} å¤„ç†æ–‡ä»¶ç±»å‹: {}", 
            parser.getClass().getSimpleName(), fileType);
        
        return parser;
    }
    
    /**
     * æ£€æŸ¥æ˜¯å¦æ”¯æŒè¯¥æ–‡ä»¶ç±»å‹
     */
    public boolean isSupported(String fileType) {
        return parserMap.containsKey(fileType.toLowerCase());
    }
    
    /**
     * è·å–æ‰€æœ‰æ”¯æŒçš„æ–‡ä»¶ç±»å‹
     */
    public List<String> getSupportedTypes() {
        return parserMap.keySet().stream().sorted().collect(Collectors.toList());
    }
}
```

## ğŸ¯ æ–‡æ¡£è§£æå™¨ä½¿ç”¨ç¤ºä¾‹

```java
package com.example.itqabot.service;

import com.example.itqabot.dto.DocumentMetadata;
import com.example.itqabot.entity.KnowledgeDoc;
import com.example.itqabot.exception.DocumentParseException;
import com.example.itqabot.factory.DocumentParserFactory;
import com.example.itqabot.parser.DocumentParser;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Slf4j
@Service
public class DocumentParsingService {
    
    @Autowired
    private DocumentParserFactory parserFactory;
    
    /**
     * è§£ææ–‡æ¡£å†…å®¹
     */
    public String parseDocument(String filePath, String fileType) throws DocumentParseException {
        DocumentParser parser = parserFactory.getParser(fileType);
        return parser.parse(filePath);
    }
    
    /**
     * è·å–æ–‡æ¡£å…ƒæ•°æ®
     */
    public DocumentMetadata getDocumentMetadata(String filePath, String fileType) 
            throws DocumentParseException {
        DocumentParser parser = parserFactory.getParser(fileType);
        return parser.getMetadata(filePath);
    }
    
    /**
     * è§£æå¹¶æ›´æ–°æ–‡æ¡£ä¿¡æ¯
     */
    public void parseAndUpdateDocument(KnowledgeDoc doc) {
        try {
            DocumentParser parser = parserFactory.getParser(doc.getFileType());
            
            String content = parser.parse(doc.getFilePath());
            DocumentMetadata metadata = parser.getMetadata(doc.getFilePath());
            
            if (doc.getTitle() == null || doc.getTitle().isEmpty()) {
                doc.setTitle(metadata.getTitle());
            }
            
            if (metadata.getPageCount() != null) {
                log.info("æ–‡æ¡£é¡µæ•°: {}", metadata.getPageCount());
            }
            
            if (metadata.getSlideCount() != null) {
                log.info("æ–‡æ¡£å¹»ç¯ç‰‡æ•°: {}", metadata.getSlideCount());
            }
            
        } catch (DocumentParseException e) {
            log.error("æ–‡æ¡£è§£æå¤±è´¥: docId={}", doc.getId(), e);
            throw new RuntimeException("æ–‡æ¡£è§£æå¤±è´¥", e);
        }
    }
}
```

## âš™ï¸ é…ç½®æ–‡ä»¶

### application.yml

```yaml
# æ–‡æ¡£è§£æé…ç½®
document:
  parser:
    # æ”¯æŒçš„æ–‡ä»¶ç±»å‹
    allowed-types: pdf,txt,md,docx,doc,ppt,pptx
    # æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼Œ10MBï¼‰
    max-file-size: 10485760
    # æ˜¯å¦æå–å…ƒæ•°æ®
    extract-metadata: true

# Chunkingé…ç½®
chunking:
  strategy: recursive
  max-size: 500
  overlap-size: 50
  min-chunk-size: 1
  separators: '\n\n,\n,ã€‚,ï¼,ï¼Ÿ,.,!,?, ,'
  
  document-types:
    pdf:
      max-size: 800
      overlap-size: 100
    md:
      max-size: 600
      overlap-size: 80
    docx:
      max-size: 700
      overlap-size: 90
    ppt:
      max-size: 400
      overlap-size: 50
    txt:
      max-size: 500
      overlap-size: 50
```

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

```java
package com.example.itqabot.parser;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import static org.junit.jupiter.api.Assertions.*;

@SpringBootTest
class DocumentParserTest {
    
    @Autowired
    private DocumentParserFactory parserFactory;
    
    @Test
    void testPdfParser() throws Exception {
        DocumentParser parser = parserFactory.getParser("pdf");
        assertNotNull(parser);
        
        String content = parser.parse("test.pdf");
        assertNotNull(content);
        assertFalse(content.isEmpty());
    }
    
    @Test
    void testPptParser() throws Exception {
        DocumentParser parser = parserFactory.getParser("pptx");
        assertNotNull(parser);
        
        String content = parser.parse("test.pptx");
        assertNotNull(content);
        assertTrue(content.contains("=== å¹»ç¯ç‰‡"));
    }
    
    @Test
    void testUnsupportedFileType() {
        assertThrows(UnsupportedOperationException.class, () -> {
            parserFactory.getParser("exe");
        });
    }
}
```

## ğŸ“š æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†
- æ•è·å¹¶è®°å½•æ‰€æœ‰è§£æå¼‚å¸¸
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯
- æ”¯æŒé‡è¯•æœºåˆ¶

### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨try-with-resourcesç¡®ä¿èµ„æºé‡Šæ”¾
- æ‰¹é‡å¤„ç†å¤§å‹æ–‡æ¡£
- ç¼“å­˜è§£æç»“æœ

### 3. æ—¥å¿—è®°å½•
- è®°å½•è§£æå¼€å§‹å’Œç»“æŸæ—¶é—´
- è®°å½•æ–‡æ¡£å¤§å°å’Œé¡µæ•°
- è®°å½•å¼‚å¸¸å †æ ˆä¿¡æ¯

### 4. å®‰å…¨è€ƒè™‘
- éªŒè¯æ–‡ä»¶ç±»å‹
- é™åˆ¶æ–‡ä»¶å¤§å°
- æ¸…ç†æ•æ„Ÿä¿¡æ¯

## ğŸ”— å‚è€ƒèµ„æº

- [Apache PDFBox](https://pdfbox.apache.org/)
- [Apache POI](https://poi.apache.org/)
- [Flexmark](https://github.com/vsch/flexmark-java)
- [Jsoup](https://jsoup.org/)
- [LangChain4j](https://docs.langchain4j.dev/)
