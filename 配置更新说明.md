# 📦 配置体系更新说明

> **重要提示**：本项目配置体系已于 2026年1月13日 进行了全面优化，以符合开源项目标准。

---

## ✨ 主要变更

### 1. 配置文件标准化

**旧配置体系**（已废弃）：
```
docker-compose.yml              ❌ 已删除
docker-compose-server.yml       ❌ 已删除
application-docker.yml          ❌ 已删除
```

**新配置体系**（当前使用）：
```
docker-compose.dev.yml          ✅ 本地开发环境
docker-compose.prod.yml         ✅ 生产环境
application.yml                 ✅ 通用基础配置
application-dev.yml             ✅ 开发环境配置
application-prod.yml            ✅ 生产环境配置
```

### 2. 安全性提升

- ✅ 移除所有硬编码的API密钥和密码
- ✅ 使用环境变量管理敏感信息
- ✅ `.env` 文件已加入 `.gitignore`
- ✅ 提供 `.env.example` 配置模板

### 3. 部署命令变更

**本地开发环境**：
```bash
# 旧命令（已废弃）
docker-compose up -d

# 新命令（请使用）
docker-compose -f docker-compose.dev.yml up -d
```

**生产环境**：
```bash
# 旧命令（已废弃）
docker-compose -f docker-compose-server.yml up -d

# 新命令（请使用）
docker-compose -f docker-compose.prod.yml up -d
```

---

## 🚀 快速开始

### 首次部署

1. **配置环境变量**
   ```bash
   cp .env.example .env
   nano .env  # 填入API密钥等配置
   ```

2. **构建后端**
   ```bash
   cd backend
   mvn clean package -DskipTests
   cd ..
   ```

3. **启动服务**
   ```bash
   # 本地开发
   docker-compose -f docker-compose.dev.yml up -d --build
   
   # 生产环境
   docker-compose -f docker-compose.prod.yml up -d
   ```

4. **验证部署**
   ```bash
   curl http://localhost:8083/api/v1/health
   ```

### 详细文档

- 📘 [快速部署指南](./docs/快速部署指南.md) - 完整的部署流程
- 📗 [环境变量配置说明](./docs/环境变量配置说明.md) - 环境变量详解
- 📕 [配置审计报告](./docs/配置审计报告.md) - 配置优化详情
- 📙 [配置迁移指南](./docs/配置迁移指南.md) - 从旧配置迁移指南

---

## ⚠️ 重要提醒

### 对于已部署项目

如果您已经使用旧配置部署了项目，请参考 [配置迁移指南](./docs/配置迁移指南.md) 进行迁移。

### 对于新项目

直接使用新配置体系，参考 [快速部署指南](./docs/快速部署指南.md)。

### 环境变量必填项

以下配置必须在 `.env` 文件中填写：

- `ALIYUN_API_KEY` - [获取地址](https://dashscope.console.aliyun.com/apiKey)
- `DEEPSEEK_API_KEY` - [获取地址](https://platform.deepseek.com/api_keys)
- `JWT_SECRET` - 强随机字符串（生产环境必须修改）

---

## 📂 项目结构（配置相关）

```
EchoCampus-Bot/
├── .env.example                          # 环境变量模板 ✅
├── .env                                  # 实际环境变量（gitignore）✅
├── docker-compose.dev.yml                # 本地开发环境 ✅
├── docker-compose.prod.yml               # 生产环境 ✅
├── backend/
│   ├── Dockerfile                        # Docker构建文件
│   └── src/main/resources/
│       ├── application.yml               # 通用配置 ✅
│       ├── application-dev.yml           # 开发环境配置 ✅
│       └── application-prod.yml          # 生产环境配置 ✅
└── docs/
    ├── 快速部署指南.md                   # 部署文档 ✅
    ├── 环境变量配置说明.md               # 环境变量说明 ✅
    ├── 配置审计报告.md                   # 审计报告 ✅
    └── 配置迁移指南.md                   # 迁移指南 ✅
```

---

## 🔐 安全提示

- ❌ 不要将 `.env` 文件提交到版本控制
- ❌ 不要在代码中硬编码敏感信息
- ✅ 生产环境使用强密码和JWT密钥
- ✅ 定期轮换API密钥和密码
- ✅ 限制CORS白名单

---

**更新日期**：2026年1月13日  
**配置版本**：标准化环境配置体系 v2.0
